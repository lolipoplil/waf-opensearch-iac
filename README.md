–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –∑–∞—â–∏—Ç—ã –≤–µ–±-—Ç—Ä–∞—Ñ–∏–∫–∞ (WAF + SIEM)
–î–∞–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Å –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –∑–∞—â–∏—Ç—ã –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π. –ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ —Ä–∞–º–∫–∞—Ö –≤—ã–ø—É—Å–∫–Ω–æ–π –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã (–í–ö–†).

üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- WAF (Web Application Firewall): –ü—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä Nginx —Å –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –º–æ–¥—É–ª–µ–º ModSecurity –∏ –Ω–∞–±–æ—Ä–æ–º –ø—Ä–∞–≤–∏–ª OWASP Core Rule Set (CRS).
- SIEM-—Å–∏—Å—Ç–µ–º–∞: –°–±–æ—Ä, –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏ –∞–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –Ω–∞ –±–∞–∑–µ OpenSearch.
- –ó–∞—â–∏—Ç–∞ –æ—Ç DoS: –ö–∞—Å—Ç–æ–º–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –ª–∏–º–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ —É—Ä–æ–≤–Ω—è—Ö L7 (ModSecurity) –∏ L4/L7 (Nginx).
- IaC (Infrastructure as Code): –ü–æ–ª–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–æ–≤ —Å –ø–æ–º–æ—â—å—é Ansible.
- CI/CD: –ü–∞–π–ø–ª–∞–π–Ω Jenkins –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è –∏ –∫–æ–Ω—Ç—Ä–æ–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π.

üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫
- OS: Fedora
- Web: Nginx (—Å–±–æ—Ä–∫–∞ –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π ModSecurity v3)
- Security: ModSecurity v3, OWASP CRS
- Logging: Fluent-bit (–∞–≥–µ–Ω—Ç —Å–±–æ—Ä–∞), OpenSearch (—Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è)
- Automation: Ansible, Jenkins, Git

üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
.
.‚îú‚îÄ‚îÄ inventory/               # –°–ø–∏—Å–æ–∫ —Ö–æ—Å—Ç–æ–≤ (WAF, OpenSearch)
.‚îú‚îÄ‚îÄ roles/                   # Ansible-—Ä–æ–ª–∏
.‚îÇ   ‚îú‚îÄ‚îÄ common               # –ë–∞–∑–æ–≤–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã
.‚îÇ   ‚îú‚îÄ‚îÄ waf                  # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Nginx + ModSecurity + –ü—Ä–∞–≤–∏–ª–∞
.‚îÇ   ‚îú‚îÄ‚îÄ nginx_target         # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–µ–ª–µ–≤–æ–≥–æ —Ö–æ—Å—Ç–∞ —Å Nginx
.‚îÇ   ‚îú‚îÄ‚îÄ opensearch           # –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –ø–æ–∏—Å–∫–æ–≤–æ–≥–æ –¥–≤–∏–∂–∫–∞ –∏ Dashboards
.‚îÇ   ‚îî‚îÄ‚îÄ fluent-bit           # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≥–µ–Ω—Ç–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ª–æ–≥–æ–≤
.‚îú‚îÄ‚îÄ playbooks/
.‚îÇ   ‚îî‚îÄ‚îÄ site.yml             # –ì–ª–∞–≤–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
.‚îú‚îÄ‚îÄ Jenkinsfile              # –û–ø–∏—Å–∞–Ω–∏–µ —ç—Ç–∞–ø–æ–≤ CI/CD –ø–∞–π–ø–ª–∞–π–Ω–∞
.‚îî‚îÄ‚îÄ ansible.cfg              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Ansible

üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- –ù–∞–ª–∏—á–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ Jenkins —Å –ø–ª–∞–≥–∏–Ω–æ–º Ansible.
- –î–æ—Å—Ç—É–ø –ø–æ SSH –∫ —Ü–µ–ª–µ–≤—ã–º —Å–µ—Ä–≤–µ—Ä–∞–º (WAF –∏ OpenSearch) –ø–æ –∫–ª—é—á–∞–º.
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π Ansible –Ω–∞ —É–∑–ª–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (Jenkins-node).

–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
- –°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
git clone https://github.com/lolipoplil/waf-opensearch-iac.git
- –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª inventory/hosts.ini, —É–∫–∞–∑–∞–≤ IP-–∞–¥—Ä–µ—Å–∞ –≤–∞—à–∏—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤.
- –°–æ–∑–¥–∞–π—Ç–µ Pipeline –≤ Jenkins, —É–∫–∞–∑–∞–≤ –ø—É—Ç—å –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é.
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–±–æ—Ä–∫—É (Build Now).

üõ° –ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞—â–∏—Ç—ã
1. SQL Injection (SQLi)

curl "http://<WAF_IP>/test?id=1%27%20OR%20%271%27=%271"

–†–µ–∑—É–ª—å—Ç–∞—Ç: –ö–æ–¥ –æ—Ç–≤–µ—Ç–∞ 403 Forbidden. –ò–Ω—Ü–∏–¥–µ–Ω—Ç –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω –≤ OpenSearch.

2. DoS Protection (Rate Limiting)

ab -n 200 -c 10 http://<WAF_IP>/

–†–µ–∑—É–ª—å—Ç–∞—Ç: –ü–æ—Å–ª–µ 100-–≥–æ –∑–∞–ø—Ä–æ—Å–∞ —Å–∏—Å—Ç–µ–º–∞ –≤–µ—Ä–Ω–µ—Ç 429 Too Many Requests. –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–Ω–∏–º–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ 60 —Å–µ–∫—É–Ω–¥.

üìù –í–∞–∂–Ω—ã–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏—è –ø–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- OpenSearch: –í –¥–∞–Ω–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Security Plugin –æ—Ç–∫–ª—é—á–µ–Ω (plugins.security.disabled: true) –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å—Ç–µ–Ω–¥–∞.
- ModSecurity: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –∑–∞—â–∏—Ç—ã –æ—Ç DoS —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –≤ roles/waf/files/custom_dos.conf.
- Configuration Drift: Ansible –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ –ø–∞–π–ø–ª–∞–π–Ω–∞.

–í—ã–ø–æ–ª–Ω–∏–ª: –ü—Ä–∏—Ö–æ–¥—å–∫–æ –î. –ú.
–ö–∞—Ñ–µ–¥—Ä–∞: –ú–ú–ó–ò–∏–ö–ë, –¢–û–ì–£.
